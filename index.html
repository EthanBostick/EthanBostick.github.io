<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethan | Portfolio</title>
    
    <link rel="stylesheet" href="styles/normalize.css">
    <link rel="stylesheet" href="styles/styles.css">

    <script src="https://cjrtnc.leaningtech.com/3.0/cj3loader.js"></script>
</head>
<body>

    <header class="site-header">
        <div class="container">
            <h1 class="logo">ethan@etonkabonk:~$</h1>
            <nav>
                <a href="#about">./about</a>
                <a href="#projects">./projects</a>
                <a href="#terminal">./play_zork</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section id="about" class="intro-grid">
            <div class="text-content">
                <h2>About Me</h2>
                <p>Hello. I'm a developer focusing on systems, data, and retro-gaming. Welcome to my digital workspace.</p>
                <a href="#terminal" class="btn primary">Run Game</a>
            </div>
            <div class="image-wrapper">
                <img src="images/selfie.JPG" alt="Ethan's Portrait" class="profile-pic">
            </div>
        </section>

        <section id="terminal" class="game-section">
            <h2>Interactive Terminal</h2>
            <div class="terminal-window">
                <div class="terminal-bar">
                    <div class="dots">
                        <span class="dot red"></span>
                        <span class="dot yellow"></span>
                        <span class="dot green"></span>
                    </div>
                    <span class="title">ethan@etonkabonk: ~/Work/Portfolio/textGame</span>
                </div>
                <div id="console-display" class="terminal-body">
                    <p class="loading-text">Initializing Java Virtual Machine...</p>
                </div>
            </div>
            <p class="caption">Type commands directly into the window above.</p>
        </section>
    </main>

    <footer class="site-footer">
        <p>&copy; 2026 Ethan. Built with &hearts; and Debian.</p>
    </footer>

	<script>
		(async function() {
			try {
				await cheerpjInit();
				const consoleElement = document.getElementById('console-display');
				consoleElement.innerHTML = ""; 
				await cheerpjCreateDisplay(80, 25, consoleElement);

				// 1. Calculate the real web URL for the map
				// e.g., "https://ethanbostick.github.io/textGame/dungeon.zork"
				let rootUrl = window.location.href;
				// Handle if url ends with index.html
				if (rootUrl.endsWith("index.html")) {
					rootUrl = rootUrl.substring(0, rootUrl.lastIndexOf("/") + 1);
				}
				if (!rootUrl.endsWith("/")) {
					rootUrl += "/";
				}

				// Adjust this path if your index.html is in the root but game is in subfolder
				// Assuming structure: root -> textGame -> dungeon.zork
				const mapUrl = rootUrl + "textGame/dungeon.zork";
				
				// 2. The JAR still needs the virtual path to run
				let rootPath = window.location.pathname;
				 if (rootPath.endsWith("index.html")) {
					rootPath = rootPath.substring(0, rootPath.lastIndexOf("/") + 1);
				}
				const jarVirtualPath = "/app" + rootPath + "textGame/Zork.jar";

				console.log("Passing URL to Java:", mapUrl);

				// 3. Pass the HTTP URL as the argument
				await cheerpjRunJar(jarVirtualPath, [mapUrl]);

			} catch (e) {
				console.error(e);
			}
		})();
	</script>
</body>
</html>
